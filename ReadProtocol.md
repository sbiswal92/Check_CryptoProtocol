## Needham Schroeder Protocol : (Implemented)

The protocol aims at sending secret from A to B by establishing the identities of both. Following steps : 

0. A generates its nonce Na.
1. A sends (part of a secret : Na) message to B encrypted with KB : (A,Na)<KB> 
2. B decrypts the message using its own key and generates its nonce Nb.
3. B sends the other part of secret (Nb) encrypted with KA to A : (Na,Nb)<KA> 
4. A decrypts the message using its own key and verifies that sender is B by matching "Na". 
5. A sends Nb part to B encrypted with KB: (Nb)<KB>
6. B decrypts it and verifies sender is A by matching "Nb"


### Attack : 
If somehow an Imposter, I manages to convince A to send him message then I can masquerade as A while communicating with B as follows : 

1. A sends (part of a secret : Na) message to I encrypted with KI : (A,Na)<KI> 
2. I sends the same message encrypted with KB to B : (A,Na)<KB> 
3. B decrypts the message using its own key and thinks that message is sent from A. B generates its nonce, Nb.
3. B sends Na and Nb encrypted with KA to I (which B assumes to be A) : (Na,Nb)<KA>
4. I relays the message as it is to A : (Na,Nb)<KA>
4. A decrypts the message using its own key and verifies that sender is I (relayed from I) by matching "Na". 
5. A sends Nb part to I encrypted with KI: (Nb)<KI>
6. I decrypts it and gets the message and sends it over to B encrypted with KB : (Nb)<KB>

Hence, the imposter manages to get the secret (Na,Nb)



## Otway-Rees Protocol : (Implemented)

The protocol aims at sending secret from A to B by establishing the identities of both with a Server S. A communicates with S only via B. Following steps : 

Assumptions : 
Kas -- encryption/decryption key is available with A and S
Kbs -- encryption/decryption key is available with B and S
Kab -- encryption/decryption key is to be obtained from S for A and B

1. A sends to B : S,A,B,(NA,S,A,B)Kas
2. B sends to S : S,A,B,(NA,S,A,B)Kas, (NB,S,A,B)Kbs
3. S sends to B : S,(NA,Kab)Kas,(NB,Kab)Kbs
4. B sends to A : S,(NA,Kab)Kas

Now, A and B both have their common key, Kab which can be used to send secret.

### Attack :
If intruder I impersonates as B : I(B) and does not send data over to S the following attack can be tracked :

Assumptions : 
Kai -- encryption/decryption key is available with A and I(B)
Kab -- encryption/decryption key is to be obtained from S for A and B

1. A sends to I(B) : S,A,B,(NA,S,A,I)Kas
2. I(B) sends back to A the same message : S,(NA,S,A,I)Kas

Since A thinks I is the actual B due to impersonation, A interpretes this message containing two parts, its nonce:(NA) and Kab:(S,A,B). A now sends secret to I(B) with key as (S,A,B) which I already knows of and I gets hold of the secret.

## Kerberos Protocol : (Implemented)

1. A sends B an authenticator message encrypted with secret key K : (Auth)K
2.  B decrypts the message using K and verifies the content of Auth 
3.  B send A the Auth encrypted with K : (Auth)K
4. A decrypts the Auth using K and matches the content of original Auth to verify sender is B.

The secret key,K here is a common key generated by KDC (Key Distribution Centre)


